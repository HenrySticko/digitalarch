(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["camera"],{1275:function(t,e,a){"use strict";a("dfb6")},"50cf":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fragment"},[a("window",{attrs:{id:"window-"+t.id,lock:t.isLocked}},[a("title-bar",{attrs:{icon:t.id,title:t.$t(t.id)}},[a("controls")],1),a("div",{staticClass:"container container-camera p-0"},[a("video",{directives:[{name:"show",rawName:"v-show",value:t.stream,expression:"stream"}],ref:"video"}),a("div",{staticClass:"camtrol"},[a("button",{staticClass:"camtrol-facing camtrol--sm",on:{click:t.switchFacing}},[a("i",{staticClass:"fa fa-refresh fa-lg"})]),a("button",{staticClass:"camtrol-capture",on:{click:t.captureImage}},[a("i",{staticClass:"fa fa-camera-retro fa-2x"})]),a("button",{staticClass:"camtrol-config camtrol--sm",on:{click:t.toggleShowConfig}},[a("i",{staticClass:"fa fa-info fa-lg"})])])])],1),t.error?a("error-message",{on:{close:function(e){t.error=null}}},[t._v(t._s(t.error)+".")]):t._e(),t.showConfig?a("window-static",{staticClass:"help"},[a("title-bar",{attrs:{title:t.$t("camera")}},[a("controls",{attrs:{hideMaximize:"",hideMinimize:"",close:t.toggleShowConfig}})],1),a("div",{staticClass:"container"},[a("p",[a("label",[t._v(t._s(t.$t("resolution"))+":")]),t._v(" 1280x720 ")]),a("p",[a("label",[t._v(t._s(t.$t("format"))+":")]),t._v(" JPEG ")]),a("p",[a("label",[t._v(t._s(t.$t("quality"))+":")]),t._v(" 100% ")]),a("div",{staticClass:"flex justify-end mt-4"},[a("winui-button",{staticClass:"default",on:{click:function(e){return e.stopPropagation(),t.toggleShowConfig(e)}}},[t._v(" "+t._s(t.$t("ok"))+" ")]),a("winui-button",{on:{click:function(e){return e.stopPropagation(),t.toggleShowConfig(e)}}},[t._v(" "+t._s(t.$t("cancel"))+" ")])],1)])],1):t._e(),t.canSave?a("dialog-save",{attrs:{parent:t.id,dialogIcon:t.id,dialogName:"save-as",content:t.image,fileName:t.fileName,fileTypes:t.fileTypes},on:{cancel:function(e){t.canSave=!1},done:function(e){t.canSave=!1}}}):t._e()],1)},s=[],n=a("3af2"),o=a("b468"),r=a("1574"),c=a("6210"),l=a("10dc"),f=a("7e41"),u=a("0fbc"),m={data(){return{id:"camera",stream:null,error:null,image:null,showConfig:!1,canSave:!1,faceFront:!0,fileName:Date.now().toString(),fileTypes:{jpeg:"JPEG file (*.jpeg)"}}},computed:{isLocked(){return!!this.error||this.showConfig||this.canSave}},mounted(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return this.showError({name:"NotSupportedError",message:"Camera is not supported on this device"});this.getCamera()},destroyed(){this.clearStream()},methods:{getCamera(){this.clearStream();const t={width:1280,height:720,facingMode:this.faceFront?"user":"environment"};navigator.mediaDevices.getUserMedia({video:t}).then(this.captureStream).catch(this.showError)},captureStream(t){const{video:e}=this.$refs;e.srcObject=t,e.onloadedmetadata=()=>{e.play(),this.stream=t}},clearStream(){if(!this.stream)return;const[t]=this.stream.getVideoTracks();t.stop()},captureImage(){if(!this.stream)return;const[t]=this.stream.getVideoTracks(),{width:e,height:a}=t.getSettings();this.image=Object(u["i"])(this.$refs.video,e,a),this.canSave=!0},switchFacing(){this.faceFront=!this.faceFront,this.getCamera()},toggleShowConfig(){this.showConfig=!this.showConfig},showError(t){this.error=t.message}},components:{Controls:n["a"],TitleBar:c["a"],Window:l["a"],WindowStatic:f["a"],ErrorMessage:r["a"],DialogSave:o["a"]}},d=m,h=(a("1275"),a("2877")),p=Object(h["a"])(d,i,s,!1,null,"12f0406f",null);e["default"]=p.exports},"6a8a4":function(t,e,a){"use strict";a("a6cd")},a6cd:function(t,e,a){},b468:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fragment"},[a("computer",{attrs:{dialog:"",dialogIcon:t.dialogIcon,dialogName:t.dialogName,filter:["directory"],lock:t.showConfirmReplace,parent:t.parent},on:{close:t.cancel,change:t.setPath},scopedSlots:t._u([{key:"footer",fn:function(){return[a("div",{staticClass:"form-control"},[a("label",[t._v(t._s(t.$t("file-name"))+":")]),a("winui-textbox",{on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.saveFile(e)}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),a("div",{staticClass:"form-control"},[a("label",[t._v(t._s(t.$t("save-as"))+":")]),a("winui-dropdown",{model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.fileTypes,(function(e,i){return a("option",{key:i,domProps:{value:i}},[t._v(" "+t._s(t.fileTypes[i])+" ")])})),0)],1),a("div",{staticClass:"buttons"},[a("winui-button",{staticClass:"default",attrs:{disabled:!t.canSave},on:{click:function(e){return e.stopPropagation(),t.saveFile(e)}}},[t._v(" "+t._s(t.$t("save"))+" ")]),a("winui-button",{on:{click:function(e){return e.stopPropagation(),t.cancel(e)}}},[t._v(" "+t._s(t.$t("cancel"))+" ")])],1)]},proxy:!0}])}),t.showConfirmReplace?a("confirm-replace",{attrs:{title:t.$t(t.dialogName)},on:{yes:function(){return t.save(!0)},no:t.toggleConfirmReplace}}):t._e()],1)},s=[],n=a("4cca"),o=a("13a7"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("core-message",{attrs:{noPreTag:"",type:"warning",title:t.title},on:{close:function(e){return t.$emit("no")}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("winui-button",{on:{click:function(e){return t.$emit("yes")}}},[t._v(" "+t._s(t.$t("yes"))+" ")]),a("winui-button",{staticClass:"default",on:{click:function(e){return t.$emit("no")}}},[t._v(" "+t._s(t.$t("no"))+" ")])]},proxy:!0}])},[a("div",{staticClass:"ml-3"},[t._v(" "+t._s(t.$t("filename-exist"))+" "+t._s(t.$t("confirm-replace"))+" ")])])},c=[],l=a("3f55"),f={components:{CoreMessage:l["a"]},props:{title:String}},u=f,m=a("2877"),d=Object(m["a"])(u,r,c,!1,null,"809e4614",null),h=d.exports,p=a("04a5"),g=a("01b4"),v=a("0fbc"),w=a("f106"),C=a("2f62"),_=a("0e9a"),b=a("e302"),y={components:{Computer:o["default"],ConfirmReplace:h},props:{parent:String,dialogIcon:String,dialogName:String,fileName:String,fileTypes:Object,content:[String,Object,HTMLCanvasElement,ArrayBuffer],parse:Function},data(){return{type:Object.keys(this.fileTypes)[0],name:Object(_["r"])(this.fileName).name,path:null,showConfirmReplace:!1}},computed:{...Object(C["d"])(["user","desktopPath"]),canSave(){return this.path&&this.name},fullName(){return this.name+"."+this.type}},methods:{setPath(t){this.path=t},saveFile(){return this.save()},async save(t=!1){if(!this.canSave)return;const e=this.content,{path:a,fullName:i}=this,s=`${a}/${i}`;let o=null;o=this.parse?this.parse(this.type):e instanceof HTMLCanvasElement?await Object(v["f"])(e,"image/"+this.type):e;try{if(a===this.desktopPath)await this.$store.dispatch(g["a"].ShortcutAdd,{lbl:i,key:Object(n["b"])(i),icon:Object(n["e"])(i),data:o,type:"file",overwrite:t});else{const e=await w["a"].isExisting(s,a);if(e&&!t)throw new Error(p["a"].NAME_EXISTS);await w["a"].write(o,s)}this.$emit("done",{name:i,path:s})}catch(r){const t=r.message||r;t===p["a"].NAME_EXISTS?this.toggleConfirmReplace():Object(b["l"])(t)}},cancel(){this.$emit("cancel")},toggleConfirmReplace(){this.showConfirmReplace=!this.showConfirmReplace}}},S=y,k=(a("6a8a4"),Object(m["a"])(S,i,s,!1,null,"492c89cc",null));e["a"]=k.exports},dfb6:function(t,e,a){}}]);