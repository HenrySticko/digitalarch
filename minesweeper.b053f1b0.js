(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["minesweeper"],{2543:function(t,e,s){},"5b50":function(t,e,s){t.exports=s.p+"media/minesweeper-lose.b3b70bbb.mp3"},"6e04":function(t,e,s){},"7db6":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"fragment game-container"},[s("window",{class:{maximized:2===t.level},attrs:{id:"window-minesweeper",w:2===t.level?0:"auto",h:2===t.level?0:"auto",lock:t.result<0||t.stats,resizable:!1}},[s("title-bar",{attrs:{icon:"minesweeper",title:t.$t("minesweeper")}},[s("controls",{attrs:{hideMaximize:""}})],1),s("tool-bar",{attrs:{items:t.toolbar}}),s("div",{staticClass:"container"},[s("div",{ref:"grid",attrs:{id:"grid"}},t._l(t.grid.length,(function(e,i){return s("div",{key:i,staticClass:"row"},t._l(t.grid[i],(function(e,i){return s("div",{key:i,class:["cell","cell-"+e.numAdjacentMines,{opened:e.state===t.CellState.OPEN}],style:t.getCellStyle(e),on:{click:function(s){return t.open(e)}}},[t._v(" "+t._s(!e.isMine&&e.state===t.CellState.OPEN&&e.numAdjacentMines>0?e.numAdjacentMines:"")+" ")])})),0)})),0),s("div",{staticClass:"stats"},[s("img",{staticClass:"icon",attrs:{src:t.timer}}),s("div",{staticClass:"number"},[t._v(t._s(t.count))]),s("div",{staticClass:"number"},[t._v(t._s(t.options.mines))]),s("img",{staticClass:"icon",attrs:{src:t.mine}})])]),s("audio",{ref:"bgm",attrs:{src:t.bgm}}),s("audio",{ref:"sfx",attrs:{src:t.sfx}})],1),t.result?s("window",{attrs:{id:"window-minesweeper-result",centered:!0,resizable:!1,w:280}},[s("title-bar",{attrs:{title:t.$t(t.result>0?"games-won":"games-lost")}},[s("controls",{attrs:{hideMaximize:"",hideMinimize:""}})],1),s("div",{staticClass:"container"},[t.result>0?s("div",[t._v(t._s(t.$t("game-congrats")))]):s("div",[t._v(t._s(t.$t("game-sorry")))]),s("div",[t._v(t._s(t.$t("time"))+": "+t._s(t.count)+" "+t._s(t.$t("seconds")))]),s("div",{staticClass:"bts"},[s("winui-button",{on:{click:function(e){return e.stopPropagation(),t.exitGame(e)}}},[t._v(" "+t._s(t.$t("exit"))+" ")]),s("winui-button",{staticClass:"default",on:{click:function(e){return e.stopPropagation(),t.newGame(e)}}},[t._v(" "+t._s(t.$t("play-again"))+" ")])],1)])],1):t._e(),t.stats?s("window-static",{attrs:{id:"window-minesweeper-stats"}},[s("title-bar",{attrs:{title:"Minesweeper "+t.$t("statistics")}},[s("controls",{attrs:{hideMaximize:"",hideMinimize:"",close:t.toggleStats}})],1),s("div",{staticClass:"container"},[s("div",{ref:"select",staticClass:"select mb-5"},[s("div",{attrs:{value:"minesweeper-0"},on:{click:t.showStats}},[t._v(" "+t._s(t.$t("beginner"))+" ")]),s("div",{attrs:{value:"minesweeper-1"},on:{click:t.showStats}},[t._v(" "+t._s(t.$t("intermediate"))+" ")]),s("div",{attrs:{value:"minesweeper-2"},on:{click:t.showStats}},[t._v(" "+t._s(t.$t("advanced"))+" ")])]),s("winui-fieldset",{staticClass:"mb-5"},[s("legend",[t._v("Best times")]),t.statData&&t.statData.scores?s("table",t._l(t.statData.scores,(function(e,i){return s("tr",{key:i},[s("td",[t._v(t._s(t.convertTime(t.statData.scores[i].time,!0)))]),s("td",[t._v(t._s(t.convertDate(t.statData.scores[i].date)))])])})),0):t._e()]),s("div",{staticClass:"mb-5"},[t.statData?[s("div",[t._v(t._s(t.$t("games-played"))+": "+t._s(t.statData.completed))]),s("div",[t._v(t._s(t.$t("games-won"))+": "+t._s(t.statData.won))]),s("div",[t._v(t._s(t.$t("win-percentage"))+": "+t._s((t.statData.won/(t.statData.completed||1)*100).toFixed())+"%")])]:[s("div",[t._v(t._s(t.$t("games-played"))+": 0")]),s("div",[t._v(t._s(t.$t("games-won"))+": 0")]),s("div",[t._v(t._s(t.$t("win-percentage"))+": 0%")])]],2),s("div",{staticClass:"bts"},[s("winui-button",{staticClass:"default",on:{click:function(e){return e.stopPropagation(),t.toggleStats(e)}}},[t._v(" "+t._s(t.$t("close"))+" ")]),s("winui-button",{on:{click:function(e){return e.stopPropagation(),t.toggleConfirm(e)}}},[t._v(" "+t._s(t.$t("reset"))+" ")])],1)],1)],1):t._e(),t.confirm?s("confirm-reset",{attrs:{close:t.toggleConfirm},on:{reset:t.reset}}):t._e()],1)},a=[],n=s("a146"),o=s("b8f8"),r=s("3af2"),l=s("6792"),c=s("e0b8"),h=s("5b50"),u=s.n(h),d=s("9538"),f=s.n(d),m=s("f3b3"),p=s.n(m),v=s("6210"),_=s("e273"),g=s("10dc"),w=s("7e41");const{BoardStateEnum:b,CellStateEnum:C,CellFlagEnum:S}=f.a,E=t=>{const e=f.a.generateMineArray(t);return new f.a.Board(e)};var O={data(){const{user:t,assets:e}=this.$store.state,{games:s}=e;return{toolbar:[{label:this.$t("game"),items:[{label:this.$t("new-game"),onClick:this.newGame},{},{label:this.$t("beginner"),onClick:()=>this.level=0},{label:this.$t("intermediate"),onClick:()=>this.level=1},{label:this.$t("advanced"),onClick:()=>this.level=2},{},{label:this.$t("statistics"),onClick:this.toggleStats},{label:this.$t("exit"),onClick:this.exitGame}]},{label:this.$t("help"),disabled:!0}],gameStats:new c["a"]("minesweeper",t),mine:s.find(t=>t.includes("minesweeper-mine")),cell:s.find(t=>t.includes("minesweeper-cell")),timer:s.find(t=>t.includes("minesweeper-timer")),CellState:C,CellFlag:S,level:0,size:21,options:{rows:8,cols:9,mines:10},board:{},grid:[],bgm:p.a,sfx:u.a,count:0,result:0,interval:null,stats:null,confirm:null,statData:null,convertTime:n["d"],convertDate:n["c"]}},watch:{async level(t){await this.$nextTick();const e=this.size+1;let{scrollWidth:s,scrollHeight:i}=this.$refs.grid;switch(s-=1,i-=1,t){case 0:this.options={rows:8,cols:9,mines:10};break;case 1:this.options={rows:12,cols:12,mines:30};break;case 2:this.options={rows:Math.floor(i/e),cols:Math.floor(s/e),mines:Math.floor(s/e*(i/e)/2)}}},options(){this.newGame()}},mounted(){this.newGame()},methods:{getCellStyle(t){let e=null;return t.state===C.OPEN&&t.isMine&&(e=this.mine),t.state===C.CLOSED&&(e=this.cell),{backgroundImage:`url(${e})`,width:this.size+"px",height:this.size+"px"}},newGame(){this.board=E(this.options),this.grid=this.board.grid(),this.$refs.bgm.currentTime=0,this.$refs.bgm.play(),this.count=0,this.result=0,clearInterval(this.interval)},exitGame(){this.$root.$emit(l["c"].CloseWindow,"minesweeper")},open(t){if(this.board.state()===b.PRISTINE&&(this.interval=setInterval(()=>this.count++,1e3),this.gameStats.init(this.level),t.isMine))return this.board=E(this.options),this.board.openCell(t.x,t.y),void(this.grid=this.board.grid());if(this.board.state()===b.WON||this.board.state()===b.LOST)return;this.board.openCell(t.x,t.y),this.grid=this.board.grid();let e=0;if(t.isMine)this.$refs.sfx.play(),this.grid.forEach(t=>t.forEach(t=>t.state=t.isMine?C.OPEN:t.state)),this.gameStats.complete(),e=-1;else{let t=0;this.grid.forEach(e=>e.forEach(e=>{e.state===C.OPEN&&t++}));const{rows:s,cols:i,mines:a}=this.options;s*i-a===t&&(this.gameStats.win(),this.gameStats.saveScore({time:this.count,date:Date.now()}),e=1)}e&&(clearInterval(this.interval),setTimeout(()=>this.result=e,1e3))},showStats({target:t}){t||(t=this.$refs.select.firstChild);const e=t.getAttribute("value").split("-"),s=e[1],i=this.gameStats.getData();this.statData=i?i[s]:null,Array.from(this.$refs.select.children).forEach(t=>t.classList.remove("active")),t.classList.add("active"),this.temp=t},toggleStats(){this.stats=!this.stats},toggleConfirm(){this.confirm=!this.confirm},reset(){this.gameStats.reset(),this.showStats({target:this.temp}),this.toggleConfirm()}},components:{Controls:r["a"],TitleBar:v["a"],ToolBar:_["a"],Window:g["a"],WindowStatic:w["a"],ConfirmReset:o["a"]}},$=O,y=(s("d2af"),s("2877")),N=Object(y["a"])($,i,a,!1,null,"f48b3ec2",null);e["default"]=N.exports},"7e41":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:["window window-static active",{centered:t.centered}]},[t._t("default")],2)},a=[],n={props:{centered:{type:Boolean,default:!0}}},o=n,r=(s("f3aa"),s("2877")),l=Object(r["a"])(o,i,a,!1,null,"49606194",null);e["a"]=l.exports},9538:function(t,e,s){var i,a;(function(){"use strict";var s={CLOSED:0,OPEN:1},n={NONE:0,EXCLAMATION:1,QUESTION:2},o={PRISTINE:0,IN_PROGRESS:1,LOST:2,WON:3},r=function(t,e,i,a){this.x=t||0,this.y=e||0,this.isMine=!!i,this.numAdjacentMines=a||0,this.state=s.CLOSED,this.flag=n.NONE},l=function(t){var e;try{e=f(t)}catch(s){e=!1}if(!e)throw new Error("The mine array supplied to Board constructor was not valid");this._state=o.PRISTINE,this._numRows=t.length,this._numCols=t[0].length,this._numMines=u(t,this._numRows,this._numCols),this._grid=h(t,this._numRows,this._numCols)};l.prototype.state=function(){return this._state},l.prototype.numRows=function(){return this._numRows},l.prototype.numCols=function(){return this._numCols},l.prototype.numMines=function(){return this._numMines},l.prototype.grid=function(){var t,e,s=[];for(t=0;t<this._numRows;t++)for(s.push([]),e=0;e<this._numCols;e++)s[t].push(this.cell(e,t));return this._grid},l.prototype._cell=function(t,e){if(t>=0&&e>=0&&e<this._numRows&&t<this._numCols)return this._grid[e][t]},l.prototype.cell=function(t,e){return v({},this._cell(+t,+e))},l.prototype.cycleCellFlag=function(t,e){var i=this._cell(+t,+e),a=!0;i&&i.state!==s.OPEN&&this._state!==o.WON&&this._state!==o.LOST&&(i.flag===n.NONE?i.flag=n.EXCLAMATION:i.flag===n.EXCLAMATION?i.flag=n.QUESTION:i.flag===n.QUESTION?i.flag=n.NONE:a=!1,a&&this._state===o.PRISTINE&&(this._state=o.IN_PROGRESS),this._updateState())},l.prototype.openCell=function(t,e){var i=this._cell(t,e);i&&i.state!==s.OPEN&&i.flag===n.NONE&&this._state!==o.WON&&this._state!==o.LOST&&(i.state=s.OPEN,i.isMine||(this._floodFill(t+1,e),this._floodFill(t-1,e),this._floodFill(t,e+1),this._floodFill(t,e-1),this._floodFill(t+1,e+1),this._floodFill(t-1,e-1),this._floodFill(t-1,e+1),this._floodFill(t+1,e-1)),this._state===o.PRISTINE&&(this._state=o.IN_PROGRESS),this._updateState())},l.prototype._floodFill=function(t,e){var i=this._cell(t,e);i&&!i.isMine&&i.state===s.CLOSED&&i.flag===n.NONE&&(i.state=s.OPEN,0===i.numAdjacentMines&&(this._floodFill(t+1,e),this._floodFill(t-1,e),this._floodFill(t,e+1),this._floodFill(t,e-1),this._floodFill(t+1,e+1),this._floodFill(t-1,e-1),this._floodFill(t-1,e+1),this._floodFill(t+1,e-1)))},l.prototype._updateState=function(){var t,e,i,a=!0;for(e=0;e<this._numRows;e++)for(t=0;t<this._numCols;t++)if(i=this._cell(t,e),i.state===s.OPEN){if(i.isMine)return void(this._state=o.LOST)}else i.state===s.CLOSED&&(i.isMine?i.flag!==n.EXCLAMATION&&(a=!1):a=!1);a&&(this._state=o.WON)};var c=function(t){var e,s,i,a,n,o=[];for(t=t||{},i=t.rows||10,a=t.cols||t.rows||10,n=t.mines||parseInt(i*a*.15,10)||0,s=i*a,e=0;e<s;e++)e<n?o.push(1):o.push(0);return o=m(o),o=p(o,a),o},h=function(t,e,s){var i,a,n=[];for(a=0;a<e;a++)for(n[a]=[],i=0;i<s;i++)n[a][i]=new r(i,a,1===t[a][i],d(t,i,a));return n},u=function(t,e,s){var i,a,n=0;for(a=0;a<e;a++)for(i=0;i<s;i++)1===t[a][i]&&n++;return n},d=function(t,e,s){var i,a,n=e+1,o=s+1,r=t[0].length,l=t.length,c=0;for(a=s-1;a<=o;a++)for(i=e-1;i<=n;i++)a===s&&i===e||a>=0&&i>=0&&a<l&&i<r&&1===t[a][i]&&c++;return c},f=function(t){var e,s,i,a,n=!0;if(t&&t.length)for(i=t.length,a=t[0]?t[0].length:0,0===a&&(n=!1),e=0;e<i;e++)if(t[e].length!==a)n=!1;else for(s=0;s<a;s++)0!==t[e][s]&&1!==t[e][s]&&(n=!1);else n=!1;return n},m=function(t){var e,s,i=t.length;while(i)s=Math.floor(Math.random()*i--),e=t[i],t[i]=t[s],t[s]=e;return t},p=function(t,e){var s,i=t.length/e,a=[];for(s=0;s<i;s++)a.push(t.splice(0,e));return a},v=function(t,e){var s,i={};for(s in t)Object.prototype.hasOwnProperty.call(t,s)&&(i[s]=t[s]);for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&(i[s]=e[s]);return i},_={Cell:r,CellStateEnum:s,CellFlagEnum:n,Board:l,BoardStateEnum:o,generateMineArray:c};"undefined"!==typeof t.exports?t.exports=_:(i=[],a=function(){return _}.apply(e,i),void 0===a||(t.exports=a))})()},"988e":function(t,e,s){},a146:function(t,e,s){"use strict";s.d(e,"d",(function(){return a})),s.d(e,"c",(function(){return n})),s.d(e,"a",(function(){return o})),s.d(e,"b",(function(){return r}));var i=s("0f35");function a(t,e=!1){const s=60;return t>=s?`${Object(i["m"])((t/s).toFixed())}:${Object(i["m"])(t%s)}`:e?"00:"+Object(i["m"])(t):t+" seconds"}function n(t){return new Date(t).toLocaleDateString("en-US")}const o={PurblePlace:"purbleplace",PurblePair:"purblepair",PurbleShop:"purbleshop",ComfyCakes:"comfycakes"},r={Master:"Purble Master",Champ:"Champion of Logic",Detective:"Senior Detective"}},b497:function(t,e,s){"use strict";s("988e")},b8f8:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("window-static",{staticClass:"auto-w",attrs:{id:t.id}},[s("title-bar",{attrs:{title:t.$t("reset")+" "+t.$t("statistics")}},[s("controls",{attrs:{hideMaximize:"",hideMinimize:"",close:t.handleClose}})],1),s("div",{staticClass:"container"},[s("div",{staticClass:"mb-5"},[t._v(t._s(t.$t("confirm-reset")))]),s("section",[s("winui-button",{staticClass:"default",on:{click:function(e){return e.stopPropagation(),t.reset(e)}}},[t._v(" "+t._s(t.$t("yes"))+" ")]),s("winui-button",{on:{click:function(e){return e.stopPropagation(),t.handleClose(e)}}},[t._v(" "+t._s(t.$t("no"))+" ")])],1)])],1)},a=[],n=s("3af2"),o=s("6210"),r=s("7e41"),l={props:{id:String,close:Function},methods:{handleClose(){this.close&&this.close()},reset(){this.$emit("reset")}},components:{TitleBar:o["a"],Controls:n["a"],WindowStatic:r["a"]}},c=l,h=(s("b497"),s("2877")),u=Object(h["a"])(c,i,a,!1,null,"02f8c3b6",null);e["a"]=u.exports},d2af:function(t,e,s){"use strict";s("6e04")},e0b8:function(t,e,s){"use strict";s.d(e,"a",(function(){return n}));var i=s("968c");const a={total:0,completed:0,won:0};class n{constructor(t,e){this.user=e,this.key=t,i["a"].local.get("scores-"+t,this.user).then(t=>{this.data=t||{0:{...a,scores:[]},1:{...a,scores:[]},2:{...a,scores:[]}}})}getData(){return this.data}saveData(){i["a"].local.update("scores-"+this.key,this.user,this.data)}init(t){this.level=t,this.data[this.level].total++,this.saveData()}saveScore(t,e=((t,e)=>t.time-e.time)){const{scores:s}=this.data[this.level];s.push(t),s.sort(e),s.length>5&&s.pop(),this.complete()}win(){this.data[this.level].won++,this.saveData()}complete(){this.data[this.level].completed++,this.saveData()}reset(t=this.key){i["a"].local.remove("scores-"+t,this.user),this.data={0:{...a,scores:[]},1:{...a,scores:[]},2:{...a,scores:[]}}}}},f3aa:function(t,e,s){"use strict";s("2543")},f3b3:function(t,e,s){t.exports=s.p+"media/minesweeper-new.45363df5.mp3"}}]);